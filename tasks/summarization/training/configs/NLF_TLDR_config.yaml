data:
  name_or_path: CarperAI/openai_summarize_tldr
  remote: true
  test_split_name: None
  train_split_name: train
  valid_split_name: valid
logging:
  log_interval: 500
  save_interval: 1000
  run_id: '33345'
  run_name: NLF_TLDR_v2
  save_dir: /cluster/work/sachan/NLF/nlf_v2
  scratch_dir: /cluster/scratch/sabadal/nlf/NLF_TLDR_v2
  wandb_entity: sauc-ms-thesis
  wandb_log: true
  wandb_project: nlf
model:
  policy_model:
    input_padding_side: left
    name_or_path: CarperAI/openai_summarize_tldr_sft
  ref_policy:
    name_or_path: CarperAI/openai_summarize_tldr_sft
  tokenizer:
    name_or_path: EleutherAI/gpt-j-6b
reward:
  batch_size: 96
  half: true
  load_state_dict: true
  max_length: 550
  name_or_path: CarperAI/openai_summarize_tldr_sft
  state_dict_path: /cluster/work/sachan/sauc/summarize_from_feedback/reward_model/rm_checkpoint/pytorch_model.bin
train:
  clip_grad: false
  cuda_deterministic: true
  entropy_coef: 0.06
  kl_coef: 0.05
  lr: 2e-5
  max_grad_norm: 1.0
  max_input_length: 1024
  sampling_batch_size_per_card: 32
  seed: 42
  total_episodes: 40960
  warmup_ratio: 0.05
  training_batch_size_per_card: 8
  num_samples_per_prompt: 10
  unfrozen_layers_ratio: 0.3
  datapool_drop_factor: 1.0
